{% if settings.DISQUS_SHORTNAME %}
    <h2 class="tab-nav" rel="#comments">Comments</h2>
    
    <div class="tab" id="comments">
        <div id="disqus_thread"></div>
    
        <script type="text/javascript">

          var disqus_shortname = '{{ settings.DISQUS_SHORTNAME }}';

          var disqus_identifier, disqus_developer;

          {% if settings.STAGING %}
            disqus_developer  = 1;
          {% endif %}

          {% if object and object.css_class %}
            {# If we have an object then we can use that to create a very robust identifier #}
            disqus_identifier = '{{ object.css_class }}-{{ object.id }}';          
          {% else %}
            {# If not object then use the page url pathname (ie without the fragment or query). This is most likely the right thing to do. #}
            disqus_identifier = window.location.pathname;
          {% endif %}
    
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
    
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
{% endif %}
