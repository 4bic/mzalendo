#
# INSTALL - instructions for getting dev environment up and running on
# MacOS 10.7 (Lion)
#

# Where to install:
#
# Apart from the git folder you will download below many other folders get
# created with dynamic data in them. These folders are all created in the
# directory that the git repo is in. I suggest that you create a folder called
# 'mzalendo_root' and put the git repo in that. Then all other folders will
# also be in the mzalendo_root folder and won't clutter up your machine.



# Install the GitHub GUI http://mac.github.com/

# Download the code:
* Go to https://github.com/mysociety/mzalendo
* Click the 'Clone in Mac' button
* In the GitHub app accept the cloning and wait for it to finish (may take a while as it pulls in lots of other stuff)

# The rest of these instructions are done on the commandline - use an app like
# 'Terminal' or 'iTerm'.


# You need xapian - the search engine. Install using 'brew' (or fink, or macports)
sudo brew install xapian --python

# remember to add 'export PYTHONPATH=/usr/local/lib/python:$PYTHONPATH' to your
# ~/.bash_profile so that the xapian bindings get found.


# some more bits that are needed
sudo brew install bcrypt
sudo brew install libjpeg

# install some needed python modules
sudo easy_install pyyaml psycopg2 xapian-haystack south py-bcrypt markdown django-markdown pyyaml httplib2 PIL



# You'll need Postgres (and postgis) installed. 


# create the database - assuming here that you're calling it 'mzalendo'
createdb -T template_postgis mzalendo


# go to the mzalendo Django project
cd your/path/to/mzalendo


# copy config example and set values needed ('mate' is the text editor
# TextMate, substitute your own if needed)
cp conf/general-example.yml conf/general.yml
mate conf/general.yml


# change to the django project
cd pylib/mzalendo


# try running the manage command - should return a list of possible subcommands.
# If there are errors please fix them and let us know what was needed.
./manage.py


# get all the data organized (worth running after pulling fresh changes)
./post_git_pull_dev_commands.bash 



# run the dev server
./manage.py runserver


# get some test data - please contact mySociety to arrange acces to the
# MzalendoTestData dropbox folder.


# log in to the admin and change the setting in 'sites' to your machine


# Get Busy!



###### NOTES ########

Currently the GitHub app does not appear to update the submodules so this needs
to be done by hand. Run 'git submodule update' to do it.
